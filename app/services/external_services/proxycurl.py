from proxycurl_py.asyncio import Proxycurl, do_bulk
from typing import List
from app.core import settings
from proxycurl_py.asyncio.base import Result
import asyncio
import logging


class ProxycurlClient:

    def __init__(self):
        self.proxycurl_client = Proxycurl(api_key=settings.PROXYCURL_API_KEY)

    async def get_bulk_profiles(self, urls: List):
        jobs = []
        for url in urls:
            jobs.append((self.proxycurl_client.linkedin.person.get, {"url": url, "fallback_to_cache": "on-error"}))
        result = await do_bulk(jobs)

        return result

    async def get_profile(self, url: str):
        result = await self.proxycurl_client.linkedin.person.get(url=url, fallback_to_cache="on-error", use_cache='if-recent')
        return result


proxycurl_api_client = ProxycurlClient()


if __name__ == "__main__":

    from app.schemas import GetLinkedinProfilesResponse
    import csv
    import app.utils as utils


    with open(r"C:\Users\immi\PyCharmProjects\Startups\kale-linkedin-api\playground\urls.csv", "r", encoding='utf-8') as f:
        reader = csv.reader(f)
        next(reader)
        urls = [utils.linkedin_utils.generate_url(url=row[0], profile=True) for row in reader]
    print(urls)

    #proxycurl_client = ProxycurlClient()
    #loop = asyncio.get_event_loop()
    #res = loop.run_until_complete(proxycurl_client.get_bulk_profiles(urls=urls))
    #print(res)
    #loop.close()
    #

    res = [Result(success=True, value={'public_identifier': 'imrannooraddin', 'profile_pic_url': 'https://s3.us-west-000.backblazeb2.com/proxycurl/person/imrannooraddin/profile?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=0004d7f56a0400b0000000001%2F20231017%2Fus-west-000%2Fs3%2Faws4_request&X-Amz-Date=20231017T131716Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=131ced651a6014db5a9dae9c293e95140d53f2f7c76b19075182ab65b8a507a3', 'background_cover_image_url': 'https://s3.us-west-000.backblazeb2.com/proxycurl/person/imrannooraddin/cover?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=0004d7f56a0400b0000000001%2F20231017%2Fus-west-000%2Fs3%2Faws4_request&X-Amz-Date=20231017T131716Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=c7f6d31b868dd68e9e003bdd617ce729e00e7fee4416eedc68cbb8bf45576f03', 'first_name': 'Imran', 'last_name': 'Nooraddin', 'full_name': 'Imran Nooraddin', 'follower_count': 193, 'occupation': 'Senior Data Scientist at DeckMatch', 'headline': 'Data Science | Python Development | Synthetic Biology', 'summary': 'Just a run-of-the-mill synthetic biologist turned data scientist looking to overcome learned helplessness', 'country': 'ES', 'country_full_name': 'Spain', 'city': 'Valencia', 'state': 'Valencian Community', 'experiences': [{'starts_at': {'day': 1, 'month': 5, 'year': 2023}, 'ends_at': {'day': 30, 'month': 9, 'year': 2023}, 'company': 'DeckMatch', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/deckmatch/', 'title': 'Senior Data Scientist', 'description': 'Leverage a wide theoretical understanding of software engineering and NLP to develop a service that simplifies matchmaking in the VC-space', 'location': 'Oslo, Norway', 'logo_url': 'https://media.licdn.com/dms/image/D4D0BAQERU_QoI809-g/company-logo_400_400/0/1682586085445?e=1704931200&v=beta&t=7wBFj1EbEMiyLD6YOdow_GXFCUbI7S0zmAyRe1y1n2I'}, {'starts_at': {'day': 1, 'month': 12, 'year': 2020}, 'ends_at': {'day': 30, 'month': 9, 'year': 2022}, 'company': 'Advice to a Scientist', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/advice-to-a-scientist/', 'title': 'Data Scientist', 'description': '•\tHead the development of an initiative focused on providing high-quality, curated scientific mentorship to support individuals in selecting career paths.\n•\tDemonstrate strong software and project management and development skills.\n•\tMaintain responsibility for overseeing existing software.\n•\tLeverage strong interpersonal and communications skills to proactively collaborate with cross-functional team members.', 'location': None, 'logo_url': 'https://media.licdn.com/dms/image/C4E0BAQE0lqFQI1SLMg/company-logo_400_400/0/1654322577902?e=1704931200&v=beta&t=XsnKsTtQlgQk90XIrTS2LBzGl5hUUBTCp9PsOX_o1EE'}, {'starts_at': {'day': 1, 'month': 12, 'year': 2021}, 'ends_at': {'day': 31, 'month': 8, 'year': 2022}, 'company': 'Institut Pasteur', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/institut-pasteur/', 'title': 'Research Engineer', 'description': '• I aim to harness the power of Diversity Generating Retroelements (DGR) to develop an accelerated platform for the directed evolution of CRISPR-dCas9 systems with the aim of producing new Cas9 variants with different PAM-interacting domains in vivo.\n• Combine my interest for data science with my strong experimental output to generate an ML algorithm that can match and filter proteins based on AlphaFold folding data\n• Rely on a strong foundation in molecular biology to troubleshoot and proceed with a complex and multifaceted project', 'location': 'Paris, Île-de-France, France', 'logo_url': 'https://media.licdn.com/dms/image/C560BAQH2Hq1M1jR8IQ/company-logo_400_400/0/1583233227775?e=1704931200&v=beta&t=Z0D_nJ4EdW4T4oNIXvTXwTN9CKTN1xLgMa4--qFRi2U'}, {'starts_at': {'day': 1, 'month': 1, 'year': 2021}, 'ends_at': {'day': 31, 'month': 12, 'year': 2021}, 'company': 'iGEM Paris Bettencourt 2021', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/igem-paris-bettencourt-2021/', 'title': 'Student Researcher & Developer', 'description': '• Spearhead the development of a project focused on producing native ATP generation in minicells through light induction & tight plasmid expression control.\n• Showcase high-quality molecular biological techniques and knowledge.\n• Identify and resolve complex issues in a timely and effective manner.\n• Leverage strong interpersonal and communications skills to proactively collaborate with cross-functional team members.', 'location': 'Paris, Île-de-France, France', 'logo_url': 'https://media.licdn.com/dms/image/C4D0BAQEQQ6tBamFUAA/company-logo_400_400/0/1616354674997?e=1704931200&v=beta&t=9rbYAo4QNXroL-EtyEWod1k-39aGdpMrILIFEX75M9E'}, {'starts_at': {'day': 1, 'month': 2, 'year': 2021}, 'ends_at': {'day': 30, 'month': 6, 'year': 2021}, 'company': 'Norwegian University of Science and Technology (NTNU)', 'company_linkedin_profile_url': None, 'title': 'Visiting Student Researcher', 'description': '•\tLed the development of a project to design and analyze novel methods for the production, and isolation of E. coli-derived minicells\n•\tPioneered the development of a bacterial promoter recognition heatmap generator, as well as a proprietary codon harmonization bioinformatic tool\n•\tIdentified and resolved complex issues in a timely and effective manner.\n•\tUtilized strong knowledge of programming languages, such as R, Python, and more.', 'location': 'Trondheim, Trøndelag, Norway', 'logo_url': 'https://media.licdn.com/dms/image/C4D0BAQHQ7O_T1TbFqg/company-logo_400_400/0/1519914019115?e=1704931200&v=beta&t=rdrEg0D7hCiAm3iIfHNlqrAM0jQL6s0NV9TwRwdRQ94'}, {'starts_at': {'day': 1, 'month': 11, 'year': 2015}, 'ends_at': {'day': 31, 'month': 8, 'year': 2016}, 'company': 'Klippelig', 'company_linkedin_profile_url': None, 'title': 'Co-Founder', 'description': '•\tPioneered the development of an autonomous, unmanned barber shop with the goal of reducing the cost of haircuts and providing services 24 hours per day.\n•\tAligned objectives and bridged communications with a business partner to execute project management, software development, graphic design, and finance.\n•\tBoosted business reach and growth by developing and deploying impactful digital, print and social media marketing campaigns.', 'location': 'Kristiansand, Vest-Agder, Norway', 'logo_url': None}], 'education': [{'starts_at': {'day': 1, 'month': 1, 'year': 2020}, 'ends_at': {'day': 31, 'month': 1, 'year': 2022}, 'field_of_study': 'Synthetic & Computational Biology', 'degree_name': "Master's degree", 'school': 'Université Paris Cité', 'school_linkedin_profile_url': None, 'description': None, 'logo_url': 'https://media.licdn.com/dms/image/D4E0BAQFnUISSfLZInw/company-logo_400_400/0/1685607076134?e=1704931200&v=beta&t=cnHbXsJTuUSIL_jMn-Ct3-rOMC9mk-fwoD2CYCOMR4E', 'grade': None, 'activities_and_societies': None}, {'starts_at': {'day': 1, 'month': 1, 'year': 2016}, 'ends_at': {'day': 31, 'month': 1, 'year': 2019}, 'field_of_study': 'Molecular Biologi', 'degree_name': 'Bachelor of Science - BS', 'school': 'University of Bergen (UiB)', 'school_linkedin_profile_url': None, 'description': None, 'logo_url': 'https://media.licdn.com/dms/image/D4D0BAQEYNxMKN2YJHQ/company-logo_400_400/0/1690965940146?e=1704931200&v=beta&t=2RWNTHGiAHNClkrKwaC4bQ2Z3k9rU5ofVxxnU07E-zU', 'grade': 'B+', 'activities_and_societies': None}, {'starts_at': {'day': 1, 'month': 7, 'year': 2018}, 'ends_at': {'day': 31, 'month': 7, 'year': 2019}, 'field_of_study': 'Molecular Biology', 'degree_name': "Bachelor's degree", 'school': 'University of Cape Town', 'school_linkedin_profile_url': None, 'description': None, 'logo_url': 'https://media.licdn.com/dms/image/C560BAQEFCqoOrVEFCA/company-logo_400_400/0/1519856479029?e=1704931200&v=beta&t=_A47Hw-MYX9U_QkWvGXFtrIZqgO2daztsWcOPoW8734', 'grade': None, 'activities_and_societies': None}], 'languages': [], 'accomplishment_organisations': [], 'accomplishment_publications': [], 'accomplishment_honors_awards': [], 'accomplishment_patents': [], 'accomplishment_courses': [], 'accomplishment_projects': [{'starts_at': {'day': 1, 'month': 9, 'year': 2020}, 'ends_at': None, 'title': 'Detecting Severe COVID-19 Through Smartwatch Sensors', 'description': 'The aim is to develop the first real-time monitoring of severe COVID-19-linked inflammatory molecules through IR & red LED sensors present on most commercial smartwatches.', 'url': None}, {'starts_at': {'day': 1, 'month': 11, 'year': 2018}, 'ends_at': {'day': 30, 'month': 6, 'year': 2019}, 'title': 'Production of a Simple Bioreactor', 'description': 'Developed a yeast bioreactor with the aim to produce the Spidroin-1A protein by utilizing DNA from N. clavipes (see Gaines WA et al. 2008), resulting in non-satisfactory results with the need for further investigation.', 'url': None}, {'starts_at': {'day': 1, 'month': 1, 'year': 2018}, 'ends_at': {'day': 31, 'month': 5, 'year': 2018}, 'title': 'Nuclear Localization of Phosphatidylinositol (3,4,5)-trisphosphate (PIP3) in HeLa Cells', 'description': 'Performed research into the nuclear localization of PIP3 through high affinity and specificity EGFP-tagged cytohesin-3 PH-domain probes.', 'url': None}], 'accomplishment_test_scores': [], 'volunteer_work': [{'starts_at': {'day': 1, 'month': 8, 'year': 2018}, 'ends_at': {'day': 31, 'month': 7, 'year': 2019}, 'title': 'Risk Officer', 'cause': 'POVERTY_ALLEVIATION', 'company': 'SHAWCO Health', 'company_linkedin_profile_url': None, 'description': '•\tCultivated relationships and consulted with children in Khayelitsha, Mitchels Plain, and other areas.\n•\tSupported minors in escaping violent and difficult family situations.\n•\tContributed to the health of the community by administering TB and HIV tests.\n•\tHandled challenging and escalated situations by leveraging strong conflict management skills.\n•\tEducated individuals on developing critical life skills to support long-term success.\n•\tMaintained a calm and collected demeanor in challenging and difficult situations.', 'logo_url': None}, {'starts_at': {'day': 1, 'month': 8, 'year': 2016}, 'ends_at': {'day': 30, 'month': 4, 'year': 2018}, 'title': 'Bartender', 'cause': None, 'company': 'Integrerbar', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/integrerbar/', 'description': None, 'logo_url': 'https://media.licdn.com/dms/image/C560BAQE4zry51Wo7VQ/company-logo_400_400/0/1519866475103?e=1704931200&v=beta&t=8wTpHyXdyJMLO_ZmR-7hJguLemv8uVaAAtlgx0POeD4'}], 'certifications': [], 'connections': None, 'people_also_viewed': [{'link': 'https://www.linkedin.com/in/renehellenes', 'name': 'René Hellenes', 'summary': 'Frontend Developer at Deckmatch', 'location': None}, {'link': 'https://www.linkedin.com/in/lgasteen', 'name': 'Léopold Gasteen', 'summary': 'Co-Founder of DeckMatch | AI & Capital', 'location': None}, {'link': 'https://www.linkedin.com/in/ajanthanchristopher', 'name': 'Ajanthan Christopher', 'summary': 'Operation Coordinator Bring Equipment AS', 'location': None}, {'link': 'https://www.linkedin.com/in/walidfmustapha', 'name': 'Walid Fayez Mustapha, PhD', 'summary': 'Co-Founder of DeckMatch | Data & AI', 'location': None}, {'link': 'https://www.linkedin.com/in/bhavna-paul-65ba8118a', 'name': 'Bhavna Paul', 'summary': 'Deltidsansatt på Bring, Posten', 'location': None}, {'link': 'https://www.linkedin.com/in/anna-abrahamsen-3b3892212', 'name': 'Anna Abrahamsen', 'summary': 'PhD candidate', 'location': None}, {'link': 'https://www.linkedin.com/in/ole-didrik-h-gundersen-bb6205111', 'name': 'Ole Didrik H. Gundersen', 'summary': 'Student - Electrical Engineering i OsloMet – storbyuniversitetet', 'location': None}, {'link': 'https://www.linkedin.com/in/isha-thapliyal-723807a2', 'name': 'Isha Thapliyal', 'summary': 'Analyst | Leader | Banking | Business Development (Looking for opportunities in Oslo, Norway)', 'location': None}, {'link': 'https://www.linkedin.com/in/chernenko-stas', 'name': 'Stas C.', 'summary': 'Lead Protocol Engineer', 'location': None}, {'link': 'https://www.linkedin.com/in/cedricmorgantini', 'name': 'Cédric Morgantini', 'summary': 'Python / Django development | Marketing', 'location': None}], 'recommendations': [], 'activities': [], 'similarly_named_profiles': [{'name': 'imran nooraddin', 'link': 'https://no.linkedin.com/in/imran-nooraddin-a93842108', 'summary': '--', 'location': 'Norvegia'}, {'name': 'Imran Nooraddin', 'link': 'https://ae.linkedin.com/in/imran-nooraddin-96513125', 'summary': 'Student at School of Research Science, Dubai', 'location': 'Emirati Arabi Uniti'}], 'articles': [], 'groups': [], 'skills': [], 'inferred_salary': None, 'gender': None, 'birth_date': None, 'industry': None, 'extra': None, 'interests': [], 'personal_emails': [], 'personal_numbers': []}, error=None), Result(success=True, value={'public_identifier': 'lukasmacner', 'profile_pic_url': 'https://s3.us-west-000.backblazeb2.com/proxycurl/person/lukasmacner/profile?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=0004d7f56a0400b0000000001%2F20231017%2Fus-west-000%2Fs3%2Faws4_request&X-Amz-Date=20231017T131716Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=f089aaa1c23037d7516aff6c35298d08007127571fb25e752014c80dc362d30a', 'background_cover_image_url': None, 'first_name': 'Lukas', 'last_name': 'Macner', 'full_name': 'Lukas Macner', 'follower_count': 5443, 'occupation': 'Commercial Lead at AhoyConnect (acquired)', 'headline': 'Founder', 'summary': "Research --> VC --> BigTech --> Startups --> 🚀\n\nDef. not a founder in stealth - Just ask me about my startup and I'll talk your ear off", 'country': 'UK', 'country_full_name': 'United Kingdom', 'city': None, 'state': None, 'experiences': [{'starts_at': {'day': 1, 'month': 1, 'year': 2022}, 'ends_at': {'day': 31, 'month': 7, 'year': 2023}, 'company': 'AhoyConnect (acquired)', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/ahoyconnect/', 'title': 'Commercial Lead', 'description': 'Guardian of the 💰\n\nAE / BDR Manager \n\nOn a mission to become the leading community data intelligence platform, enabling organisations to understand, grow, engage, automate, give and derive value from their audiences.\n\nWe believe community-led is the ‘next big thing’ for how creators, startups, and enterprises grow, but... today, community managers lack the understanding of what really happens inside their audience and what value it brings to the business. \n\nThat is why we’re building AhoyConnect - a community data intelligence platform enabling organizations to understand, grow, engage, automate, and derive value from their online audiences.', 'location': 'Worldwide', 'logo_url': 'https://media.licdn.com/dms/image/C4D0BAQElP1qdfwKxZw/company-logo_400_400/0/1626786273993?e=1704931200&v=beta&t=_qwhZlGoSN8jq5gvevaZaMXYBsEOJ6qD6yaNjMmfmfA'}, {'starts_at': {'day': 1, 'month': 5, 'year': 2021}, 'ends_at': {'day': 31, 'month': 1, 'year': 2022}, 'company': 'Time is Ltd.', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/timeisltd/', 'title': 'Growth', 'description': 'Time is Ltd. Analytics empowers leadership teams to understand team dynamics, communication patterns, meeting culture, and much more\n\nTime is Ltd For Teams Empower employees, improve collaboration, and drive team performance using positive psychology\n\nWe empower smarter work at all levels of an organization\n\n- 25%\xa0Increase in Team Output\n- 90,000+ Hours Free Up Per Year\n- 10%\xa0Increase in employee satisfaction', 'location': None, 'logo_url': 'https://media.licdn.com/dms/image/C4D0BAQHh7W5ktneGLA/company-logo_400_400/0/1585723064835?e=1704931200&v=beta&t=F_zmILWnmPgYBoKF4d08i89acpbEAZVs15AOdnzad6M'}, {'starts_at': {'day': 1, 'month': 1, 'year': 2018}, 'ends_at': {'day': 31, 'month': 1, 'year': 2021}, 'company': 'LinkedIn', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/linkedin/', 'title': 'Business Leadership Programme / Sales', 'description': 'A selective program to build a pipeline for future talent for the company\n\nAdvising Enterprise + SMB companies on optimal hiring and talent development strategies\nImproved a product feature using network analysis\nHighest quarterly performance in Q4 2019 EMEA + LATAM\nWorked with Product Marketing and Product Management on several GTM strategies', 'location': None, 'logo_url': 'https://media.licdn.com/dms/image/C560BAQHaVYd13rRz3A/company-logo_400_400/0/1638831589865?e=1704931200&v=beta&t=BB7_F1PTWS9krPEMLaONwZkq0uFKxHqx_h1BmwjWTp8'}, {'starts_at': {'day': 1, 'month': 1, 'year': 2018}, 'ends_at': {'day': 31, 'month': 1, 'year': 2018}, 'company': 'Angel Ventures', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/angel-ventures-mexico/', 'title': 'Entrepreneur in Residence', 'description': 'Working together with Angel Ventures and PAD Red de Àngeles\n\nAdvising the funds on strategy/fundraising/investments\n\nHelping the local startup ecosystem from the side of Venture Capital', 'location': 'Lima, Perú', 'logo_url': 'https://media.licdn.com/dms/image/C4E0BAQHjfae1sfngLA/company-logo_400_400/0/1678840212040?e=1704931200&v=beta&t=pMrQgOVV8Pk7W_B0T312-nE9uGypLGF0l890LoVZNBY'}, {'starts_at': {'day': 1, 'month': 1, 'year': 2018}, 'ends_at': {'day': 31, 'month': 1, 'year': 2018}, 'company': 'Cherry Ventures', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/cherry-ventures/', 'title': 'Finance/ Investment Analyst', 'description': "Working on fund financials with the Operating Partner and other Partners\nGetting an indepth view of the fund's operations\nBeing involved in dealflow generation and evaluation of startups\nResearching about interesting industries and opportunities", 'location': 'Berlin Area, Germany', 'logo_url': 'https://media.licdn.com/dms/image/C4D0BAQG2zHoUmrds3A/company-logo_400_400/0/1588157526757?e=1704931200&v=beta&t=x-oRUMzJpDaNe1St_UEtwZxT-m18PsiDtwAwHfvbvpg'}, {'starts_at': {'day': 1, 'month': 1, 'year': 2013}, 'ends_at': {'day': 31, 'month': 1, 'year': 2018}, 'company': 'SONEAN', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/sonean/', 'title': 'Senior Researcher, SNA Lab Member', 'description': 'As a SNA (social network analysis) based strategy consultant and intelligence partner, we bring the complementary social network perspective into our clients` decision making processes and move them beyond financial and non-financial data to help identify risks and opportunities in a unique manner. \n\nMonitored competitive environments through projects with Fortune 500 companies. Every project starts with the development of a unique ecosystem-model reflecting the competitive and external environment that our client and its organization are exposed to. Starting from our client`s customers (within their ecosystem) we identify their ties to competition and thus get deep insights into customer-competitor networks. The aim is to understand the entire ecosystem in which our client`s organization or portfolio investments are embedded, including customers, competitors, governments, associations, universities, NGOs and other central actors as it is key to recognize the social ties that bind these entities and look at developments and organizations not in isolation but from a socially connected perspective. \n\nWe then analyze the social capital of relevant actors such as customers and competitors (where did they study, what boards do they sit on, and e.g. where did they work) to understand the ties among actors and how it could potentially affect our client`s strategy and other organizational outcomes. After the completion of the ecosystem model, thousands of organizations and actors within the ecosystem are then dynamically monitored to identify opportunities and threats using a 3-pillar approach using automation, devoting special attention to central actors, searching in dozens of different languages based on a thesaurus for the sector in which our client operates.', 'location': 'Frankfurt Area, Germany', 'logo_url': 'https://media.licdn.com/dms/image/C4E0BAQHNrrfi-610YQ/company-logo_400_400/0/1519881467104?e=1704931200&v=beta&t=3qhHaenkhSfVqrz14CrDHeyvMrDXke-zvou9LYFiaqQ'}, {'starts_at': {'day': 1, 'month': 7, 'year': 2013}, 'ends_at': {'day': 31, 'month': 8, 'year': 2013}, 'company': 'SONEAN', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/sonean/', 'title': 'Research Intern', 'description': 'Got introduced to the world of Social Network Analysis (SNA). Worked together with the SONEAN team to analyse the executive and non-executive leaders in order to determine the ties between boards. We focused on the interactions of the board memberships and how the networks of companies have an impact on the decision processes. Mostly researched the ties between the boards and determined patterns and characteristics of the data found.', 'location': 'Frankfurt Area, Germany', 'logo_url': 'https://media.licdn.com/dms/image/C4E0BAQHNrrfi-610YQ/company-logo_400_400/0/1519881467104?e=1704931200&v=beta&t=3qhHaenkhSfVqrz14CrDHeyvMrDXke-zvou9LYFiaqQ'}, {'starts_at': {'day': 1, 'month': 1, 'year': 2017}, 'ends_at': {'day': 31, 'month': 1, 'year': 2017}, 'company': 'WeWork', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/wework/', 'title': 'Operations', 'description': 'Through collecting & analyzing data, saved costs, increased margins and customer satisfaction altogether improving processes in the properties managed.\n\nCreated a data dashboard for the organization to track KPIs. \n\nDevised a pricing tool and created a Point of Sale strategy for physical retail\n\nProject managed several initiatives.\n\nInvolved in continuous operational strategy developments.\n\nLearned about the operational challenges and opportunities of a high growth Unicorn startup.', 'location': 'London, United Kingdom', 'logo_url': 'https://media.licdn.com/dms/image/D560BAQGvcgAszRyYNg/company-logo_400_400/0/1686147967537?e=1704931200&v=beta&t=PjhqG2jfmw7Ea-MmxibMTGJ9uTw_p57R-ZEGmutT2Jg'}, {'starts_at': {'day': 1, 'month': 9, 'year': 2014}, 'ends_at': {'day': 31, 'month': 10, 'year': 2016}, 'company': "L' Essence", 'company_linkedin_profile_url': "https://www.linkedin.com/company/l'-essence/", 'title': 'Founder & CEO', 'description': "L' Essence is the creator of the world's first luxury scented hanger which increases the quality and exclusivity of hotels. The formula is simple: Luxury Hanger + Handcrafted scented capsule = Unforgettable sensory experience.  \n\nAmazing founder lessons learned such as developing a go to market strategy, creating a product that (some) people love, setting up distribution and creating partnersnhips. \n\nwww.l-essence.com", 'location': None, 'logo_url': 'https://media.licdn.com/dms/image/C4E0BAQEfMmy0yCHCZg/company-logo_400_400/0/1519904526480?e=1704931200&v=beta&t=TEunrSbVzNw7WHQlK4YuxyXO2kptSqWhaMg42ndAmME'}, {'starts_at': {'day': 1, 'month': 7, 'year': 2016}, 'ends_at': {'day': 30, 'month': 9, 'year': 2016}, 'company': 'Dow Jones', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/dow-jones/', 'title': 'Data Strategy Intern', 'description': 'Developed a web-based application that enhanced the communication between employees in the organization. Implemented on a global scale. "The Tinder for Learning"\n\nImproved a process within the department increasing efficiency in the Due Diligence process by configuring a software to automatically populate information and create reports based on inputted data. Implemented globally.\n\nContributed to the creation of Due Diligence Reports.\n\nLearned about the various business lines of Dow Jones such a Venturesource.', 'location': 'Barcelona Area, Spain', 'logo_url': 'https://media.licdn.com/dms/image/C4D0BAQGah7RTW_-lmA/company-logo_400_400/0/1594043641173?e=1704931200&v=beta&t=rEjGn81tAHLZUoY-16xERl2RPhtoN_I5pFxpIVdztGc'}, {'starts_at': {'day': 1, 'month': 7, 'year': 2013}, 'ends_at': {'day': 31, 'month': 8, 'year': 2013}, 'company': 'Funds@Work AG', 'company_linkedin_profile_url': 'https://www.linkedin.com/company/funds-work-ag/', 'title': 'Research Intern', 'description': 'Worked at a distinct strategy consultant focusing on the investment industry. Got to know the company as a whole and received deep insights into the investment industry and different methods of consulting institutional investors. \n\nAlso became aware of other realms such as Islamic Finance, Environmental Social Governance and other expertise that Funds @ Work possesses.', 'location': 'Frankfurt Area, Germany', 'logo_url': 'https://media.licdn.com/dms/image/C4D0BAQHBTrNUwPFAIQ/company-logo_400_400/0/1519902665334?e=1704931200&v=beta&t=Rd9pROWXRaCQqEUnk9IG5WVpqMz176CwtA_oQvLG4p0'}], 'education': [{'starts_at': None, 'ends_at': None, 'field_of_study': 'Business Administration & Business Analytics', 'degree_name': "Bachelor's Degree", 'school': 'IE Business School', 'school_linkedin_profile_url': None, 'description': None, 'logo_url': 'https://media.licdn.com/dms/image/C4D0BAQGvE_Hi22X6lQ/company-logo_400_400/0/1663153931884?e=1704931200&v=beta&t=PrUHtszA2Lb5zs1CZX4xVop0e8L8BnO--rwcmtmLAYk', 'grade': None, 'activities_and_societies': None}, {'starts_at': None, 'ends_at': None, 'field_of_study': 'Business/Technology - McIntire School Of Commerce', 'degree_name': 'Exchange Semester', 'school': 'University of Virginia', 'school_linkedin_profile_url': None, 'description': None, 'logo_url': 'https://media.licdn.com/dms/image/C4E0BAQEAOh2Qs3LELA/company-logo_400_400/0/1673812558884?e=1704931200&v=beta&t=XoWAzILwrG0HEvG5JjcRvdXRKPGU9oeqOiUhMok565M', 'grade': None, 'activities_and_societies': None}, {'starts_at': None, 'ends_at': None, 'field_of_study': None, 'degree_name': 'High School', 'school': 'Frankfurt International School', 'school_linkedin_profile_url': None, 'description': None, 'logo_url': 'https://media.licdn.com/dms/image/C510BAQF2wgcVr-sfCQ/company-logo_400_400/0/1519882556385?e=1704931200&v=beta&t=ALMwhQBg3RdiVNLp5LLWjLxJ-7j5AKyjpSUVVpdEFd4', 'grade': None, 'activities_and_societies': None}], 'languages': ['English', 'German', 'Slovak', 'Spanish'], 'accomplishment_organisations': [], 'accomplishment_publications': [{'name': 'What are the social networks between Venture Capital firms in the Danube Valley and what can the ecosystem do to make this region more attractive for foreign VC investment?', 'publisher': None, 'published_on': {'day': 1, 'month': 1, 'year': 2017}, 'description': None, 'url': 'https://drive.google.com/file/d/1vaODEjO6EOf3JtmfKBKkgg4cX1JzTqxc/view?usp=sharing'}, {'name': 'The influential networks behind Germany`s largest listed companies (DAX-30)', 'publisher': 'SONEAN, Handelsblatt', 'published_on': {'day': 1, 'month': 1, 'year': 2016}, 'description': None, 'url': 'https://sonean.network/wp-content/uploads/2018/05/SONEAN-Whitepaper-December-2016.pdf'}, {'name': 'Social Dependence of Independent Directors', 'publisher': 'CFA Institute, Handelsblatt, Manager Magazine, Les Echos, Het Financieele Dagblad', 'published_on': {'day': 1, 'month': 1, 'year': 2015}, 'description': None, 'url': 'https://sonean.network/wp-content/uploads/2018/05/SONEAN-Whitepaper-Feb-2015.pdf'}, {'name': 'The crucial and complementary role of social network analysis (SNA) for investments in startup companies', 'publisher': 'SONEAN', 'published_on': {'day': 1, 'month': 1, 'year': 2014}, 'description': None, 'url': 'https://sonean.network/wp-content/uploads/2018/05/SONEAN-Whitepaper-Okt-2014.pdf'}], 'accomplishment_honors_awards': [{'title': 'Member of the IE Junior Advisory Board', 'issuer': 'IE Business School', 'issued_on': {'day': 1, 'month': 6, 'year': 2013}, 'description': 'For this position received a scholarship to attend IE Business School. This is a group of young, charismatic individuals around the whole world that have advised the IE University on the future of education. Furthermore the board has also given the IE University recommendations in their programs.\n\njab.ie.edu'}], 'accomplishment_patents': [], 'accomplishment_courses': [], 'accomplishment_projects': [], 'accomplishment_test_scores': [], 'volunteer_work': [], 'certifications': [], 'connections': None, 'people_also_viewed': [{'link': 'https://www.linkedin.com/in/josh-ash', 'name': 'Josh Ash', 'summary': 'GTM @ Humaans', 'location': None}, {'link': 'https://www.linkedin.com/in/amangrowth', 'name': 'Aman Ghataura', 'summary': 'I build B2B revenue engines ⚙️ for agencies/services', 'location': None}, {'link': 'https://www.linkedin.com/in/jackson-labell-nevard-00701a177', 'name': 'Jackson Labell-Nevard', 'summary': 'Founder of TeztUs', 'location': None}, {'link': 'https://www.linkedin.com/in/stefanvujicic3', 'name': 'Stefan Vujicic', 'summary': 'Founder/Designer', 'location': None}, {'link': 'https://www.linkedin.com/in/ariccombeni-precisionmedicine-genomics', 'name': 'Alessandro Riccombeni MBA, Ph.D.', 'summary': 'Entrepreneur and investor in Precision and Genomic Medicine', 'location': None}, {'link': 'https://www.linkedin.com/in/jerome-lefebre', 'name': 'Jerome Lefebre', 'summary': 'Sr Success Manager | Remote evangelist | Ex-Dropboxer | Speaker | Ultra Runner', 'location': None}, {'link': 'https://www.linkedin.com/in/kubosquared', 'name': 'Jakub Kuba', 'summary': 'Passionate Product Manager | Data-Driven Strategic Analyst | Marketing Enthusiast', 'location': None}, {'link': 'https://www.linkedin.com/in/christofferimmanuel', 'name': 'Christoffer Immanuel', 'summary': 'Building companies with amazing humans 🌎', 'location': None}, {'link': 'https://www.linkedin.com/in/matthew-hargreaves-17a639ab', 'name': 'Matthew Hargreaves', 'summary': 'Wine Strategist', 'location': None}, {'link': 'https://www.linkedin.com/in/arikbrueckner', 'name': 'Arik Brückner', 'summary': 'Working on the next gig...', 'location': None}], 'recommendations': [], 'activities': [], 'similarly_named_profiles': [], 'articles': [], 'groups': [], 'skills': [], 'inferred_salary': None, 'gender': None, 'birth_date': None, 'industry': None, 'extra': None, 'interests': [], 'personal_emails': [], 'personal_numbers': []}, error=None)]
    x = [profile.value for i, profile in enumerate(res) if profile.error is None]
    print(x)
    model = GetLinkedinProfilesResponse(profiles=x)
    print(model)